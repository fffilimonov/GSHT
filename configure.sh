#!/bin/bash

. config;
NEWIP1=$(echo $NEWIP | awk -F "." '{print $1}');
NEWIP2=$(echo $NEWIP | awk -F "." '{print $2}');
NEWIP3=$(echo $NEWIP | awk -F "." '{print $3}');
NEWIP4=$(echo $NEWIP | awk -F "." '{print $4}');

MASK1=$(echo $MASK | awk -F "." '{print $1}');
MASK2=$(echo $MASK | awk -F "." '{print $2}');
MASK3=$(echo $MASK | awk -F "." '{print $3}');
MASK4=$(echo $MASK | awk -F "." '{print $4}');

GW1=$(echo $GW | awk -F "." '{print $1}');
GW2=$(echo $GW | awk -F "." '{print $2}');
GW3=$(echo $GW | awk -F "." '{print $3}');
GW4=$(echo $GW | awk -F "." '{print $4}');

DNS1=$(echo $DNS | awk -F "." '{print $1}');
DNS2=$(echo $DNS | awk -F "." '{print $2}');
DNS3=$(echo $DNS | awk -F "." '{print $3}');
DNS4=$(echo $DNS | awk -F "." '{print $4}');

IPCONFIG="P196=$NEWPASS&\
P901=80&\
P276=0&\
P146=&\
P148=HT7XX&\
P82=&\
P83=&\
P269=&\
P92=0&\
P93=0&\
P94=0&\
P95=0&\
P5026=&\
P5027=&\
P5028=&\
P5029=&\
P5030=&\
P5031=&\
P5032=&\
P5033=&\
P5034=&\
P5035=&\
P5036=&\
P5037=&\
P8=1&\
P9=$NEWIP1&\
P10=$NEWIP2&\
P11=$NEWIP3&\
P12=$NEWIP4&\
P13=$MASK1&\
P14=$MASK2&\
P15=$MASK3&\
P16=$MASK4&\
P17=$GW1&\
P18=$GW2&\
P19=$GW3&\
P20=$GW4&\
P21=$DNS1&\
P22=$DNS2&\
P23=$DNS3&\
P24=$DNS4&\
P25=$DNS1&\
P26=$DNS2&\
P27=$DNS3&\
P28=$DNS4&\
P64=MSK-3MSD%2CM3.5.0%2F2%2CM10.5.0%2F3&P246=MTZ%2B6MDT%2B5%2CM3.2.0%2CM11.1.0&\
P143=0&\
P342=0&\
apply=Apply"

ADVANCEDCONF="P2=$NEWPASS&\
P51=0&\
P5038=0&\
P5042=0&\
P76=&\
P84=20&\
P474=0&\
P475=3&\
P1564=0&\
P212=1&\
P192=&\
P237=&\
P1359=&\
P1360=&\
P1361=&\
P232=&\
P233=&\
P234=&\
P235=&\
P145=0&\
P194=0&\
P193=10080&\
P285=1&\
P286=1&\
P238=2&\
P4428=0&\
P240=0&\
P280=&\
P279=&\
P281=&\
P4503=&\
P4504=&\
P4505=&\
P4506=0&\
P4507=300&\
P4511=&\
P4512=&\
P8220=&\
P8221=&\
P4898=0&\
P4040=c%3D2000%2F4000%3B&\
P4000=f1%3D350%40-17%2Cf2%3D440%40-17%2Cc%3D0%2F0%3B&\
P4001=f1%3D440%40-17%2Cf2%3D480%40-17%2Cc%3D2000%2F4000%3B&\
P4002=f1%3D480%40-21%2Cf2%3D620%40-21%2Cc%3D500%2F500%3B&\
P4003=f1%3D480%40-21%2Cf2%3D620%40-21%2Cc%3D250%2F250%3B&\
P4004=f1%3D350%40-11%2Cf2%3D440%40-11%2Cc%3D100%2F100-100%2F100-100%2F100%3B&\
P4005=f1%3D440%40-13%2Cc%3D300%2F10000%3B&\
P4041=f1%3D350%40-17%2Cf2%3D440%40-17%2Cc%3D0%2F0%3B&\
P4042=&\
P88=0&\
P253=0&\
P277=0&\
P30=&\
P144=0&\
P207=&\
P208=0&\
P1387=0&\
apply=Apply"

LINE1="P271=1&\
P47=$DOMAIN&\
P967=&\
P4567=1&\
P48=$OUTBOUND&\
P1411=0&\
P130=0&\
P52=0&\
P35=$USER1&\
P36=$USER1&\
P34=$PASS1&\
P3=&\
P103=0&\
P63=0&\
P31=1&\
P81=1&\
P109=1&\
P32=2&\
P2330=35&\
P138=20&\
P5046=26&\
P5050=46&\
P40=5060&\
P39=5004&\
P20501=0&\
P20505=0&\
P135=0&\
P4560=0&\
P4830=0&\
P4562=0&\
P288=1&\
P4340=0&\
P258=0&\
P2346=0&\
P243=0&\
P2338=0&\
P2339=0&\
P4437=0&\
P209=50&\
P250=400&\
P2387=0&\
P79=101&\
P850=101&\
P851=102&\
P852=100&\
P4825=0&\
P4433=0&\
P74=0&\
P191=0&\
P71=&\
P4045=0&\
P197=&\
P101=&\
P4834=&\
P870=0&\
P871=&\
P872=0&\
P873=&\
P874=0&\
P875=&\
P91=0&\
P714=0&\
P186=0&\
P4793=0&\
P4360=0&\
P855=0&\
P1406=0&\
P137=0&\
P185=60&\
P139=20&\
P85=4&\
P29=0&\
P66=&\
P72=1&\
P4200=%7B+x%2B+%7C+*x%2B+%7C+*xx*x%2B+%7Cxxxx%7D&\
P99=0&\
P65=0&\
P129=0&\
P198=102&\
P260=180&\
P261=90&\
P262=0&\
P263=0&\
P264=0&\
P266=0&\
P267=1&\
P265=0&\
P272=0&\
P2359=0&\
P4363=0&\
P57=0&\
P58=8&\
P59=4&\
P60=18&\
P61=2&\
P62=98&\
P37=2&\
P49=0&\
P97=0&\
P96=97&\
P50=0&\
P291=0&\
P228=0&\
P4416=1&\
P133=1&\
P132=1&\
P183=0&\
P854=4&\
P853=0&\
P4661=0&\
P4662=0&\
P205=0&\
P892=0&\
P856=200&\
P4424=1&\
P251=300&\
P252=1100&\
P833=400&\
P247=0&\
P249=6&\
P824=0&\
P4441=0&\
P4429=20&\
P4234=0&\
P4010=c%3D2000%2F4000%3B&\
P4011=c%3D2000%2F4000%3B&\
P4012=c%3D2000%2F4000%3B&\
P4013=c%3D2000%2F4000%3B&\
P4014=c%3D2000%2F4000%3B&\
P4015=c%3D2000%2F4000%3B&\
P4016=c%3D2000%2F4000%3B&\
P4017=c%3D2000%2F4000%3B&\
P4018=c%3D2000%2F4000%3B&\
P4019=c%3D2000%2F4000%3B&\
apply=Apply"

LINE2="P401=1&\
P747=$DOMAIN&\
P987=&\
P4568=1&\
P748=$OUTBOUND&\
P830=0&\
P730=0&\
P735=$USER2&\
P736=$USER2&\
P734=$PASS2&\
P703=&\
P702=0&\
P763=0&\
P731=1&\
P752=1&\
P813=1&\
P732=2&\
P2430=35&\
P471=20&\
P5047=26&\
P5051=46&\
P740=5062&\
P739=5012&\
P20502=0&\
P20506=0&\
P469=0&\
P4561=0&\
P4831=0&\
P4563=0&\
P489=1&\
P4341=0&\
P449=0&\
P2446=0&\
P743=0&\
P2438=0&\
P2439=0&\
P4438=0&\
P440=50&\
P441=400&\
P2487=0&\
P779=101&\
P860=101&\
P861=102&\
P862=100&\
P4826=0&\
P4434=0&\
P774=0&\
P751=0&\
P771=&\
P4046=0&\
P792=&\
P866=&\
P4835=&\
P880=0&\
P881=&\
P882=0&\
P883=&\
P884=0&\
P885=&\
P791=0&\
P823=0&\
P817=0&\
P4794=0&\
P4361=0&\
P869=0&\
P4895=0&\
P487=0&\
P816=60&\
P470=20&\
P292=4&\
P729=0&\
P766=&\
P772=1&\
P4201=%7B+x%2B+%7C+*x%2B+%7C+*xx*x%2B+%7Cxxxx%7D&\
P709=0&\
P765=0&\
P446=0&\
P767=102&\
P434=180&\P
427=90&\
P428=0&\
P429=0&\
P430=0&\
P432=0&\
P433=1&\
P431=0&\
P435=0&\
P2459=0&\
P4364=0&\
P757=0&\
P758=8&\
P759=4&\
P760=18&\
P761=2&\
P762=98&\
P737=2&\
P749=0&\
P705=0&\
P704=97&\
P750=0&\
P460=0&\
P710=0&\
P4417=1&\
P831=1&\
P832=1&\
P443=0&\
P864=4&\
P863=0&\
P4663=0&\
P4664=0&\
P865=0&\
P893=0&\
P857=200&\
P4425=1&\
P811=300&\
P812=1100&\
P834=400&\
P248=0&\
P283=6&\
P825=0&\
P4442=0&\
P4430=20&\
P4235=0&\
P4030=c%3D2000%2F4000%3B&\
P4031=c%3D2000%2F4000%3B&\
P4032=c%3D2000%2F4000%3B&\
P4033=c%3D2000%2F4000%3B&\
P4034=c%3D2000%2F4000%3B&\
P4035=c%3D2000%2F4000%3B&\
P4036=c%3D2000%2F4000%3B&\
P4037=c%3D2000%2F4000%3B&\
P4038=c%3D2000%2F4000%3B&\
P4039=c%3D2000%2F4000%3B&\
apply=Apply"

curl -d "P2=admin&Login=Login" http://$IPGS/cgi-bin/dologin -c cookie;

curl -d "$IPCONFIG" http://$IPGS/cgi-bin/update -b cookie;

curl -d "$ADVANCEDCONF" http://$IPGS/cgi-bin/update -b cookie;

curl -d "$LINE1" http://$IPGS/cgi-bin/update -b cookie;

if [ "$USER2" != "" ]; then
    curl -d "$LINE2" http://$IPGS/cgi-bin/update -b cookie;
fi;

curl http://$IPGS/cgi-bin/rs -b cookie;
